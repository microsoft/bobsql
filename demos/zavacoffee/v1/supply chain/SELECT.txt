SELECT 
    s.store_id,
    s.store_code,
    s.store_name,
    s.city,
    s.country,
    s.status,
    COUNT(spp.product_id) as product_count
FROM zava.Store s
LEFT JOIN zava.StoreProductParam spp ON s.store_id = spp.store_id
GROUP BY s.store_id, s.store_code, s.store_name, s.city, s.country, s.status
ORDER BY product_count DESC, s.store_name;